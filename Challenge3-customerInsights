                                                    --Challenge3:Customer Insights

--Submitted By Shreya Singh 


--Q1. What are the names of all the countries in the country table?

select country_name 
from country ;

--Q2. What is the total number of customers in the customers table?

select count(*) as total_customers 
from customers;

--Q3. What is the average age of customers who can receive marketing emails (can_email is set to 'yes')?

select round(avg(age),0) as avg_age 
from customers 
where can_email = 'yes';

--Q4. How many orders were made by customers aged 30 or older?

select count(o.order_id) as total_orders 
from orders o 
join customers c 
on o.customer_id = c.customer_id 
where c.age >= 30; 

--Q5. What is the total revenue generated by each product category?

select sum(price) as total_revenue, category 
from products 
group by category; 

--Q6. What is the average price of products in the 'food' category?

select round(avg(price),2) as avg_price 
from products 
where category = 'food';

--Q7. How many orders were made in each sales channel (sales_channel column) in the orders table?

select count(order_id) as total_orders, sales_channel 
from orders 
group by sales_channel ;

--Q8. What is the date of the latest order made by a customer who can receive marketing emails?

select o.date_shop 
from orders o 
join customers c 
on o.customer_id = c.customer_id 
where c.can_email = 'yes' 
order by o.date_shop desc limit 1;

--Q9. What is the name of the country with the highest number of orders?

select count(o.order_id) as highest_num_orders, c.country_name 
from orders o 
join country c 
on o.country_id = c.country_id
group by c.country_name 
order by highest_num_orders desc limit 1;

--Q10. What is the average age of customers who made orders in the 'vitamins' product category?

select round(avg(c.age),2) as avg_age 
from customers c 
join orders o 
on c.customer_id = o.customer_id 
join baskets b 
on o.order_id = b.order_id 
join products p 
on b.product_id = p.product_id 
where category = 'vitamins';









